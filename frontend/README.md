# PRIZMA - Telegram Mini App

–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å–Ω–∏–∫ –≤ –≤–∏–¥–µ Telegram Mini App —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ò–ò –∞–Ω–∞–ª–∏–∑–∞ –ª–∏—á–Ω–æ—Å—Ç–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ó–∞–ø—É—Å–∫ HTTP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
python3 server.py
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000`

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ngrok –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Telegram

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# brew install ngrok  # –¥–ª—è macOS
# –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å https://ngrok.com/

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—É–Ω–Ω–µ–ª—å
ngrok http 8000
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTTPS URL –∏–∑ ngrok (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://abc123.ngrok.io`)

### 3. –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã:
   ```
   /newbot
   –í—ã–±–µ—Ä–∏—Ç–µ –∏–º—è: PRIZMA Psychology Bot
   –í—ã–±–µ—Ä–∏—Ç–µ username: prizma_psychology_bot
   ```
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Web App

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newapp` –≤ [@BotFather](https://t.me/BotFather)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –í–≤–µ–¥–∏—Ç–µ:
   - **Title**: PRIZMA - –ê–Ω–∞–ª–∏–∑ –ª–∏—á–Ω–æ—Å—Ç–∏
   - **Description**: –ü—Ä–æ–π–¥–∏—Ç–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ –ò–ò –∞–Ω–∞–ª–∏–∑ –≤–∞—à–µ–π –ª–∏—á–Ω–æ—Å—Ç–∏
   - **Photo**: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 640x360px
   - **Web App URL**: –í–∞—à ngrok URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://abc123.ngrok.io`)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
frontend/prizma/
‚îú‚îÄ‚îÄ index.html              # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ steps.html              # –û–ø–∏—Å–∞–Ω–∏–µ —à–∞–≥–æ–≤
‚îú‚îÄ‚îÄ login.html              # –§–æ—Ä–º–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
‚îú‚îÄ‚îÄ question.html           # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ loading.html            # –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
‚îú‚îÄ‚îÄ answers.html            # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îú‚îÄ‚îÄ price.html              # –¢–∞—Ä–∏—Ñ—ã
‚îú‚îÄ‚îÄ complete-payment.html   # –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
‚îú‚îÄ‚îÄ uncomplete-payment.html # –ù–µ—É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
‚îú‚îÄ‚îÄ download.html           # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îî‚îÄ‚îÄ main.css           # –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îú‚îÄ‚îÄ config.js          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ telegram-vanilla.js # Telegram Web App SDK
‚îÇ   ‚îú‚îÄ‚îÄ main-telegram.js   # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å Telegram
‚îÇ   ‚îú‚îÄ‚îÄ main.js            # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ jquery.min.js      # jQuery
‚îÇ   ‚îî‚îÄ‚îÄ jquery-ui.min.js   # jQuery UI
‚îú‚îÄ‚îÄ images/                # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –∏–∫–æ–Ω–∫–∏
‚îú‚îÄ‚îÄ fonts/                 # –®—Ä–∏—Ñ—Ç—ã
‚îî‚îÄ‚îÄ server.py             # HTTP —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª `js/config.js`

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```javascript
window.AppConfig = {
    api: {
        baseUrl: 'http://localhost:8080/api', // URL backend API
        // ...
    },
    telegram: {
        webAppUrl: 'https://your-domain.com', // –í–∞—à –¥–æ–º–µ–Ω
        // ...
    },
    survey: {
        totalQuestions: 15, // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤
        // ...
    }
    // ...
};
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **`api.baseUrl`** - URL –≤–∞—à–µ–≥–æ backend API
2. **`telegram.webAppUrl`** - URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
3. **`survey.questions`** - –ú–∞—Å—Å–∏–≤ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –æ–ø—Ä–æ—Å–∞
4. **`payment.prices`** - –¶–µ–Ω—ã –Ω–∞ —Ç–∞—Ä–∏—Ñ—ã
5. **`development.mockAPI`** - –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å mock API

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend

### API Endpoints

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–∂–∏–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ endpoints:

```
POST /api/user/profile      # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST /api/user/answers      # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
GET  /api/user/report       # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
POST /api/payment/create    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
GET  /api/payment/status    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
```

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```json
{
    "name": "–ò–º—è",
    "age": 25,
    "gender": "male",
    "telegramUser": {
        "id": 123456789,
        "first_name": "–ò–º—è",
        "username": "username"
    }
}
```

**–û—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```json
{
    "answers": [
        {
            "question": 1,
            "answer": "–¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞...",
            "timestamp": "2024-01-01T12:00:00.000Z"
        }
    ]
}
```

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –º–∞—Å—Å–∏–≤ `AppConfig.survey.questions` –≤ —Ñ–∞–π–ª–µ `js/config.js`

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π

–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `css/main.css`. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–∏
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- Telegram theme colors
- –¢–∞–∫—Ç–∏–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

1. –°–æ–∑–¥–∞–π—Ç–µ HTML —Ñ–∞–π–ª
2. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é:
   ```html
   <script src="js/config.js"></script>
   <script src="js/telegram-vanilla.js"></script>
   ```
3. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ `main-telegram.js`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python3 server.py`
2. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8000` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Developer Tools –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ Telegram

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Telegram

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ ngrok: `ngrok http 8000`
2. –û–±–Ω–æ–≤–∏—Ç–µ Web App URL –≤ BotFather
3. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `/start`

### Mock API

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ backend —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ `config.js`:
```javascript
development: {
    mockAPI: true
}
```

## üöÄ –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

- –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è Telegram)
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (nginx/apache)

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```javascript
// –í production —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
window.AppConfig = {
    api: {
        baseUrl: 'https://your-api.com/api'
    },
    telegram: {
        webAppUrl: 'https://your-domain.com'
    },
    development: {
        mockAPI: false,
        enableLogging: false
    }
};
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Bot

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π URL –≤ [@BotFather](https://t.me/BotFather):
```
/editapp
–í—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞
–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
Edit Web App URL
https://your-domain.com
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ HTTPS
- ‚úÖ Telegram init data –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ backend
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage
- ‚úÖ API –∫–ª—é—á–∏ –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ frontend

## üì± –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Telegram Mini App

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ (MainButton, BackButton)
- ‚úÖ –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å (HapticFeedback)
- ‚úÖ –¢–µ–º—ã Telegram (ThemeParams)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ viewport

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- ‚ùå –ì–æ–ª–æ—Å–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ùå –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞, –Ω–µ –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

## üÜò –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ Telegram
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ HTTPS –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URL –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏

### –ö–Ω–æ–ø–∫–∏ Telegram –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `telegram-vanilla.js` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `TelegramWebApp.init()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `window.Telegram.WebApp`

### API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –Ω–∞ backend
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `X-Telegram-Init-Data` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è
3. –í–∫–ª—é—á–∏—Ç–µ `mockAPI: true` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `config.js`
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º `mockAPI` 